<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Unblocked Search</title>
    <style>
        body { font-family: sans-serif; background: #222; color: #fff; text-align: center; padding: 20px; }
        input { padding: 10px; width: 70%; max-width: 400px; border-radius: 5px; border: none; }
        button { padding: 10px 20px; cursor: pointer; background: #e62117; color: white; border: none; border-radius: 5px; font-weight: bold; }
        button:hover { background: #cc1f16; }
        #results { display: flex; flex-wrap: wrap; justify-content: center; margin-top: 20px; gap: 20px; }
        .video-card { background: #333; padding: 10px; border-radius: 8px; width: 300px; text-align: left; }
        .video-card img { width: 100%; border-radius: 5px; }
        .video-card h3 { font-size: 16px; margin: 10px 0 5px; }
        /* The player overlay */
        #player-modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); justify-content: center; align-items: center; z-index: 1000; }
        iframe { width: 80%; height: 80%; max-width: 900px; border: none; }
        .close-btn { position: absolute; top: 20px; right: 30px; color: white; font-size: 30px; cursor: pointer; }
    </style>
</head>
<body>

    <h1>Video Search</h1>
    <input type="text" id="searchInput" placeholder="Search for a video...">
    <button onclick="searchVideos()">Search</button>

    <div id="results"></div>

    <div id="player-modal">
        <span class="close-btn" onclick="closePlayer()">&times;</span>
        <iframe id="videoFrame" src="" allowfullscreen></iframe>
    </div>

    <script>
        // We use a public Piped API instance to search without an API key
        // If this one is slow, you can swap "pipedapi.kavin.rocks" with "api.piped.io"
        const API_URL = "https://pipedapi.kavin.rocks"; 

        async function searchVideos() {
            const query = document.getElementById('searchInput').value;
            const resultsDiv = document.getElementById('results');
            
            if (!query) return;

            resultsDiv.innerHTML = "<p>Searching...</p>";

            try {
                // Fetch results from the Piped API
                const response = await fetch(`${API_URL}/search?q=${encodeURIComponent(query)}&filter=all`);
                const data = await response.json();

                resultsDiv.innerHTML = ""; // Clear "Searching..." text

                // Loop through results and create cards
                data.items.forEach(item => {
                    // Only show videos (skip channels/playlists for simplicity)
                    if (item.type === "stream") { 
                        const card = document.createElement('div');
                        card.className = "video-card";
                        
                        // Create the HTML for each video result
                        card.innerHTML = `
                            <img src="${item.thumbnail}" onclick="playVideo('${item.url}')" style="cursor:pointer">
                            <h3>${item.title}</h3>
                            <p>${item.uploaderName}</p>
                            <button onclick="playVideo('${item.url}')">Watch</button>
                        `;
                        resultsDiv.appendChild(card);
                    }
                });

            } catch (error) {
                console.error(error);
                resultsDiv.innerHTML = "<p>Error fetching videos. Try again or check console.</p>";
            }
        }

        function playVideo(url) {
            // Extract the ID from the URL (e.g., /watch?v=12345 -> 12345)
            const videoId = url.split("v=")[1];
            
            // Set the iframe to use Piped's player (Proxied) instead of YouTube's
            const embedUrl = `https://piped.video/embed/${videoId}`;
            
            document.getElementById('videoFrame').src = embedUrl;
            document.getElementById('player-modal').style.display = "flex";
        }

        function closePlayer() {
            document.getElementById('player-modal').style.display = "none";
            document.getElementById('videoFrame').src = ""; // Stop audio
        }
    </script>

</body>
</html>
