<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vault0 Essential</title>
    <style>
        body {
            font-family: sans-serif;
            margin: 0; padding: 0;
            background-color: #222; color: white;
            display: flex; flex-direction: column;
            height: 100vh;
        }

        /* --- THE CONTROLS (Simple & Visible) --- */
        .control-bar {
            background: #333;
            padding: 15px;
            border-bottom: 2px solid #555;
            display: flex; gap: 10px; align-items: center;
        }

        select, input, button {
            padding: 10px; font-size: 16px; border-radius: 4px; border: none;
        }

        /* Server Picker */
        #serverSelect {
            background: #000; color: #0f0; /* Bright green text so you see it */
            border: 1px solid #555;
            max-width: 200px;
        }

        /* Input Box */
        #inputBox {
            flex-grow: 1;
            background: #fff; color: #000;
        }

        /* The Button */
        #goBtn {
            background: #007bff; color: white;
            font-weight: bold; cursor: pointer;
        }
        #goBtn:hover { background: #0056b3; }

        /* --- THE VIEWER --- */
        .viewer {
            flex-grow: 1; background: #000;
            display: flex; justify-content: center; align-items: center;
        }

        iframe { width: 100%; height: 100%; border: none; }

        .help-text {
            color: #aaa; text-align: center;
        }
    </style>
</head>
<body>

    <div class="control-bar">
        <select id="serverSelect">
            <option value="https://yewtu.be">Server 1 (Invidious - NL)</option>
            <option value="https://vid.puffyan.us">Server 2 (Invidious - US)</option>
            <option value="https://inv.tux.pizza">Server 3 (Invidious - US)</option>
            <option value="https://piped.video">Server 4 (Piped - Main)</option>
            <option value="https://piped.kavin.rocks">Server 5 (Piped - US)</option>
        </select>

        <input type="text" id="inputBox" placeholder="Paste Link OR Type Search (e.g. 'Math History')" onkeypress="if(event.key==='Enter') loadVideo()">
        
        <button id="goBtn" onclick="loadVideo()">GO</button>
    </div>

    <div class="viewer">
        <iframe id="videoFrame" sandbox="allow-scripts allow-same-origin allow-popups allow-forms allow-presentation" allowfullscreen></iframe>
    </div>

    <script>
        function loadVideo() {
            const server = document.getElementById('serverSelect').value;
            const input = document.getElementById('inputBox').value.trim();
            const frame = document.getElementById('videoFrame');

            if (!input) {
                alert("Please type something first!");
                return;
            }

            // --- DETECT IF LINK OR SEARCH ---
            // Regex checks if it looks like a YouTube ID
            const regExp = /^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/;
            const match = input.match(regExp);

            if (match && match[2].length === 11) {
                // IT IS A LINK: Use /embed/ (Works on both Piped and Invidious)
                frame.src = server + "/embed/" + match[2] + "?autoplay=1";
            } else {
                // IT IS A SEARCH: We must format it based on the server type
                // Piped uses "search_query=", Invidious uses "q="
                
                if (server.includes('piped')) {
                    frame.src = server + "/results?search_query=" + encodeURIComponent(input);
                } else {
                    frame.src = server + "/search?q=" + encodeURIComponent(input);
                }
            }
        }
    </script>
</body>
</html>
