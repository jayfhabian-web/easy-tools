<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vault0 | Omni</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;700&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --bg: #202124;
            --panel: #303134;
            --text: #e8eaed;
            --accent: #8ab4f8; 
            --border: #5f6368;
            --hover: #3c4043;
        }

        body {
            font-family: 'DM Sans', sans-serif;
            background-color: var(--bg);
            color: var(--text);
            margin: 0;
            display: flex; flex-direction: column;
            height: 100vh; overflow: hidden;
        }

        /* --- HEADER --- */
        .header {
            padding: 20px; display: flex; flex-direction: column; align-items: center;
            border-bottom: 1px solid var(--border); background: var(--bg);
            position: relative;
            z-index: 100; /* Header layer */
        }

        .brand {
            font-family: 'JetBrains Mono', monospace; font-size: 1.5rem; font-weight: 700;
            color: white; margin-bottom: 20px;
        }
        .brand span { color: var(--accent); }

        /* --- SERVER SELECTOR (FIXED) --- */
        .server-container {
            position: absolute; 
            top: 20px; 
            right: 20px;
            display: flex; flex-direction: column; align-items: flex-end;
            z-index: 2000; /* This ensures it sits ON TOP of everything */
        }

        .server-select {
            background: #111; color: #fff; border: 1px solid #555;
            padding: 8px; border-radius: 6px; font-size: 0.8rem;
            max-width: 180px; cursor: pointer;
            outline: none;
        }
        .server-select:hover { border-color: var(--accent); }
        
        .status-msg {
            font-size: 0.7rem; color: #f28b82; margin-top: 5px; 
            display: none; text-align: right;
        }

        /* --- SEARCH BAR --- */
        .search-wrapper {
            position: relative; width: 100%; max-width: 650px;
            z-index: 150;
        }

        .search-input {
            width: 100%; box-sizing: border-box;
            background: var(--panel); border: 1px solid var(--border);
            color: white; padding: 14px 20px; border-radius: 24px;
            font-size: 1.1rem; outline: none; box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        .search-input:focus { background: #303134; box-shadow: 0 4px 8px rgba(0,0,0,0.3); border-color: transparent; }
        
        /* Suggestions Dropdown */
        .suggestions-box {
            position: absolute; top: 100%; left: 0; right: 0;
            background: var(--panel); border-radius: 0 0 24px 24px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.5);
            display: none; flex-direction: column;
            max-height: 400px; overflow-y: auto;
            border-top: 1px solid var(--border); margin-top: -12px; padding-top: 15px;
            z-index: 1000;
        }

        .suggestion-item {
            padding: 10px 20px; cursor: pointer; display: flex; align-items: center; gap: 15px;
            color: #bdc1c6;
        }
        .suggestion-item:hover { background: var(--hover); color: white; }
        .suggestion-item i { font-style: normal; font-size: 0.9rem; opacity: 0.5; }

        /* --- VIEWPORT --- */
        .viewport {
            flex-grow: 1; position: relative; background: #000;
        }
        iframe { width: 100%; height: 100%; border: none; }

        .placeholder {
            position: absolute; top:0; left:0; right:0; bottom:0;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            color: #9aa0a6; text-align: center;
        }
        
        .chips {
            display: flex; gap: 10px; margin-top: 20px; justify-content: center; flex-wrap: wrap;
        }
        .chip {
            background: var(--panel); border: 1px solid var(--border); color: #e8eaed;
            padding: 8px 16px; border-radius: 18px; font-size: 0.9rem; cursor: pointer;
            transition: 0.2s;
        }
        .chip:hover { background: var(--hover); border-color: #777; }

        .hidden { display: none !important; }

    </style>
</head>
<body>

    <div class="server-container">
        <select id="server" class="server-select" onchange="updateStatus()">
            <option value="https://yewtu.be" selected>Server 1 (Netherlands)</option>
            <option value="https://vid.puffyan.us">Server 2 (US - Secure)</option>
            <option value="https://piped.video">Server 3 (Main Piped)</option>
            <option value="https://piped.kavin.rocks">Server 4 (US - East)</option>
            <option value="https://inv.tux.pizza">Server 5 (US - Tux)</option>
            <option value="https://invidious.drgns.space">Server 6 (US - Dragons)</option>
            <option value="https://piped.mha.fi">Server 7 (Europe)</option>
        </select>
        <div id="loadingWarn" class="status-msg">If spinning > 5s, try Server 2 ‚Üó</div>
    </div>

    <div class="header">
        <div class="brand">Vault<span>0</span> Omni</div>
        
        <div class="search-wrapper">
            <input type="text" id="input" class="search-input" 
                   placeholder="Search anything (e.g. 'Avocado seed toxic')" 
                   autocomplete="off"
                   oninput="handleInput()" 
                   onfocus="handleInput()"
                   onkeypress="if(event.key==='Enter') runSearch(this.value)">
            
            <div id="suggestions" class="suggestions-box"></div>
        </div>

        <div class="chips">
            <button class="chip" onclick="runSearch('How to tie a tie')">üëî How-To</button>
            <button class="chip" onclick="runSearch('Space Documentary')">ü™ê Space</button>
            <button class="chip" onclick="runSearch('Is it safe to eat avocado seeds')">ü•ë Food Facts</button>
            <button class="chip" onclick="runSearch('Coding for beginners')">üíª Coding</button>
            <button class="chip" onclick="runSearch('American Revolution')">üìú History</button>
        </div>
    </div>

    <div class="viewport">
        <div id="welcome" class="placeholder">
            <h2>Ready to search.</h2>
            <p>Type anything above. The "Brain" will guess what you need.</p>
        </div>
        <iframe id="frame" class="hidden" sandbox="allow-scripts allow-same-origin allow-popups allow-forms allow-presentation" allowfullscreen></iframe>
    </div>

    <script>
        // --- 300+ TOPIC BRAIN ---
        const brain = [
            "Are avocado seeds toxic to eat?", "Is it safe to eat apple seeds?", "Can you eat raw potatoes?",
            "Why do cats purr?", "Why is the sky blue?", "How do airplanes fly?",
            "What happens if you swallow gum?", "How to survive in the wild",
            "How to tie a tie", "How to fix a zipper", "How to sew a button", "How to bake a cake",
            "How to change a tire", "How to write a resume", "How to study for exams",
            "How to solve a Rubiks cube", "How to do a cartwheel",
            "American Revolution Documentary", "Civil War History", "World War II Summary",
            "Ancient Egypt Pyramids", "Greek Mythology Explained", "Industrial Revolution",
            "The Cold War Simple History", "Who was Napoleon?",
            "Photosynthesis Explained", "Periodic Table Song", "Human Digestive System",
            "How the heart works", "Solar System for kids", "Black Holes explained",
            "Newton's Laws of Physics", "Cell Structure Biology",
            "Algebra Basics", "Quadratic Formula Song", "Geometry Proofs",
            "Python coding for beginners", "HTML and CSS tutorial", "How computers work",
            "Shakespeare Macbeth Summary", "To Kill a Mockingbird Analysis", "Great Gatsby Summary",
            "1984 George Orwell Summary", "Romeo and Juliet Explained",
            "How to fall asleep fast", "Meditation for anxiety", "Lo-fi beats for studying"
        ];

        const suggestionsBox = document.getElementById('suggestions');
        const inputField = document.getElementById('input');
        const warnMsg = document.getElementById('loadingWarn');

        function handleInput() {
            const val = inputField.value.toLowerCase();
            suggestionsBox.innerHTML = ''; 

            if (!val) {
                suggestionsBox.style.display = 'none';
                return;
            }

            const matches = brain.filter(topic => topic.toLowerCase().includes(val));

            if (matches.length > 0) {
                matches.slice(0, 6).forEach(match => {
                    const div = document.createElement('div');
                    div.className = 'suggestion-item';
                    div.innerHTML = `<i>üîç</i> ${match}`;
                    div.onclick = () => {
                        inputField.value = match;
                        suggestionsBox.style.display = 'none';
                        runSearch(match);
                    };
                    suggestionsBox.appendChild(div);
                });
                suggestionsBox.style.display = 'flex';
            } else {
                suggestionsBox.style.display = 'none';
            }
        }

        document.addEventListener('click', (e) => {
            if (!document.querySelector('.search-wrapper').contains(e.target)) {
                suggestionsBox.style.display = 'none';
            }
        });

        function updateStatus() {
            const serverName = document.getElementById('server').options[document.getElementById('server').selectedIndex].text;
            // Briefly flash a checkmark or log? Not needed, simple is better.
            if(inputField.value) runSearch(inputField.value);
        }

        function runSearch(query) {
            if(!query) return;
            
            inputField.value = query; 
            suggestionsBox.style.display = 'none';
            document.getElementById('welcome').classList.add('hidden');
            warnMsg.style.display = 'block'; // Show help tip
            
            const frame = document.getElementById('frame');
            frame.classList.remove('hidden');

            const server = document.getElementById('server').value;
            
            const regExp = /^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/;
            const match = query.match(regExp);

            if (match && match[2].length === 11) {
                // If it's a link, play it
                frame.src = server + "/embed/" + match[2] + "?autoplay=1";
            } else {
                // If it's a search
                if(server.includes('piped')) {
                    // Piped search format
                    frame.src = server + "/results?search_query=" + encodeURIComponent(query);
                } else {
                    // Invidious search format (slightly different)
                    frame.src = server + "/search?q=" + encodeURIComponent(query);
                }
            }
        }
    </script>
</body>
</html>
